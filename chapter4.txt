this is chapter 4 from master.
